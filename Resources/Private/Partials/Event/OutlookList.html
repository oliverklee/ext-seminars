<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" xmlns:oelib="OliverKlee\Oelib\ViewHelpers"
      data-namespace-typo3-fluid="true">
    <table class="table table-hover table-striped table-responsive w-auto">
        <thead>
            <tr>
                <oelib:isFieldEnabled fieldName="date">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.date"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="eventType">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.eventType"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="topic">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.topic"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="city">
                    <th scope="city">
                        <f:translate key="plugin.eventOutlook.events.property.city"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="venue">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.venue"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="vacancies">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.vacancies"/>
                    </th>
                </oelib:isFieldEnabled>
                <oelib:isFieldEnabled fieldName="registration">
                    <th scope="col">
                        <f:translate key="plugin.eventOutlook.events.property.registration"/>
                    </th>
                </oelib:isFieldEnabled>
            </tr>
        </thead>
        <tbody>
            <f:for each="{events}" as="event">
                <tr>
                    <oelib:isFieldEnabled fieldName="date">
                        <td>
                            <f:render partial="EventDate" arguments="{event: event}"/>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="eventType">
                        <td>
                            <f:if condition="{event.eventType}">
                                {event.eventType.title}
                            </f:if>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="topic">
                        <td>
                            <f:link.action action="show" arguments="{event: event}"
                                           pageUid="{settings.singleViewPage}}">
                                {event.displayTitle}
                            </f:link.action>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="city">
                        <td>
                            <f:for each="{event.cityNames}" as="cityName" iteration="iteration">
                                {cityName}{f:if(condition: iteration.isLast, then: '', else: ', ')}
                            </f:for>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="venue">
                        <td>
                            <f:for each="{event.venues}" as="venue" iteration="iteration">
                                {venue.title}{f:if(condition: iteration.isLast, then: '', else: ', ')}
                            </f:for>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="vacancies">
                        <td class="text-end">
                            <f:render partial="Event/Vacancies" arguments="{event: event, viewName: 'eventOutlook'}"/>
                        </td>
                    </oelib:isFieldEnabled>
                    <oelib:isFieldEnabled fieldName="registration">
                        <td>
                            <f:if condition="({settings.registrationPage} && {event.registrationRequired}">
                                <f:variable name="statistics" value="{event.statistics}"/>
                                <f:if condition="({event.registrationPossibleByDate} && {statistics.anyVacancies})">
                                    <f:link.action controller="EventRegistration" action="checkPrerequisites"
                                                   pageUid="{settings.registrationPage}" arguments="{event: event}">
                                        <f:if condition="{statistics.regularVacancies}">
                                            <f:then>
                                                <f:translate
                                                    key="plugin.eventOutlook.events.property.registration.register"/>
                                            </f:then>
                                            <f:else>
                                                <f:translate
                                                    key="plugin.eventOutlook.events.property.registration.waitingList"/>
                                            </f:else>
                                        </f:if>
                                    </f:link.action>
                                </f:if>
                            </f:if>
                        </td>
                    </oelib:isFieldEnabled>
                </tr>
            </f:for>
        </tbody>
    </table>
</html>
